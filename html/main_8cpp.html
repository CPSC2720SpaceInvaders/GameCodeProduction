<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>2720 Invaders: main.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">2720 Invaders
   </div>
   <div id="projectbrief">AgameinimitationofearlySHMUPs.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">main.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>An imitation of early SHMUP games like Galaga or Space Invaders. A C++ Allegro game for CPSC 2720 term project.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;allegro5/allegro.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_native_dialog.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_ttf.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_font.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_primitives.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_image.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_audio.h&gt;</code><br />
<code>#include &lt;allegro5/allegro_acodec.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &quot;<a class="el" href="projectile_8h_source.html">projectile.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="actor_8h_source.html">actor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bullet_8h_source.html">bullet.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="actor_player_8h_source.html">actorPlayer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="actor_enemy_basic_8h_source.html">actorEnemyBasic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="object_spawners_8h_source.html">objectSpawners.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad3cf59c57b6047ae36a44ae677fb1737"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ad3cf59c57b6047ae36a44ae677fb1737">enemyRemovePred</a> (const <a class="el" href="class_actor_enemy_basic.html">ActorEnemyBasic</a> target)</td></tr>
<tr class="memdesc:ad3cf59c57b6047ae36a44ae677fb1737"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicate for remove_if call on the basic enemy index.  <a href="#ad3cf59c57b6047ae36a44ae677fb1737">More...</a><br /></td></tr>
<tr class="separator:ad3cf59c57b6047ae36a44ae677fb1737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2650a9e53ff5009b70ac4fbdba61716f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#a2650a9e53ff5009b70ac4fbdba61716f">bulletRemovePred</a> (const <a class="el" href="class_projectile_bullet.html">ProjectileBullet</a> target)</td></tr>
<tr class="memdesc:a2650a9e53ff5009b70ac4fbdba61716f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Predicate for remove_if call on the bullet indices.  <a href="#a2650a9e53ff5009b70ac4fbdba61716f">More...</a><br /></td></tr>
<tr class="separator:a2650a9e53ff5009b70ac4fbdba61716f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An imitation of early SHMUP games like Galaga or Space Invaders. A C++ Allegro game for CPSC 2720 term project. </p>
<p>&ndash;Resource Credits&ndash; Eric Skiff ( <a href="http://ericskiff.com/music">http://ericskiff.com/music</a> ) for the music track Underclocked. Dalton Maag (<a href="http://www.daltonmaag.com">http://www.daltonmaag.com</a> ) for the Ubuntu font.</p>
<dl class="section author"><dt>Author</dt><dd>Victor Adad, Tyler Bertram </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000011">Bug:</a></b></dt><dd>No known bugs. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2650a9e53ff5009b70ac4fbdba61716f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bulletRemovePred </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_projectile_bullet.html">ProjectileBullet</a>&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predicate for remove_if call on the bullet indices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td><a class="el" href="class_projectile_bullet.html">ProjectileBullet</a> type object. We check the projInactive boolian member and return its value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolian value. </dd></dl>

</div>
</div>
<a class="anchor" id="ad3cf59c57b6047ae36a44ae677fb1737"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enemyRemovePred </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_actor_enemy_basic.html">ActorEnemyBasic</a>&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Predicate for remove_if call on the basic enemy index. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">target</td><td><a class="el" href="class_actor_enemy_basic.html">ActorEnemyBasic</a> type object. We check the isDead boolian member and return its value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Boolian value. </dd></dl>

</div>
</div>
<a class="anchor" id="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>&lt; Screen dimension constants.</p>
<p>&lt; Screen dimension constants.</p>
<p>&lt; Screen dimension constants.</p>
<p>&lt; Frames per second variable</p>
<p>&lt; If done == true, the game ends.</p>
<p>&lt; If draw == true, the gamestate will be drawn to the display.</p>
<p>&lt; Passed to the player object to control movement.</p>
<p>&lt; Passed to the player object to control movement.</p>
<p>&lt; If set to a negative value, the bullet will move in the opposite direction intended. This is undesirable behaviour.</p>
<p>&lt; If set to a negative value, the bullet will move in the opposite direction intended. This is undesirable behaviour.</p>
<p>&lt; Controls movement both of the player and enemies.</p>
<p>&lt; Random number storage variable for misc usage.</p>
<p>&lt; Random number storage variable for misc usage.</p>
<p>&lt; Used in animating the main menu/loading screen.</p>
<p>&lt; Vertical location in the menu bitmap to start drawing from.</p>
<p>&lt; Used to end the game when the player has completed all available stages. Note, the menu is considered stage 1, as the victory screen is stage 0 and death is stage -1.</p>
<p>&lt; If false, then displays main menu, if true, the "loading" screen will be shown.</p>
<p>&lt; Sums amount of time that the "loading" screen will be displayed.</p>
<p>&lt; Defines the current stage, which controls execution of certain code in the game loop. Initialized to 1 for the menu.</p>
<p>&lt; If true, the first-time enemy set-up for a stage will be performed. Initialized to true for this reason, so that the first stage sets up correctly.</p>
<p>&lt; Until allegro is initialized, this must be a null pointers.</p>
<p>Exception handling in the case that allegro does not initialize. This function MUST be called first.</p>
<p>&lt; Sets up the previously declared display.</p>
<p>Exception handling in case the display fails to set up.</p>
<p>Initialize various allegro modules.</p>
<p>Initialization of Allegro-specific types that required the init funcs above in order to be declared.</p>
<p>&lt; ALLEGRO_SAMPLE doesn't support mp3 or midi files.</p>
<p>&lt; Indicate how many samples (sound files) we are using.</p>
<p>Syntax for spriteIndex keys: x yz x: 0: abstract object, for instance buttons or menu elements; 1: actor sprites, for instance the player's ship 2+: misc indices, unlikely to be used yz: order of loading. For instance, 000 is the first menu object loaded.</p>
<p>&lt; Plays the main theme.</p>
<p>Create the Player actor, and all required indices for game functions.</p>
<p>GAME MAIN LOOP</p>
<p>&lt; After starting the timer, the only thing that should be done is the game loop, and subsequent object cleanup.</p>
<p>&lt; This is the game loop, right here.</p>
<p>&lt; waits for something to happen</p>
<p>&lt; IMPORTANT: gets the input from the keyboard</p>
<p>&lt; Updates and draws all elements in the game space.</p>
<p>&lt; Pressing escape key ends the program.</p>
<p>Game over screen, stage designate -1.</p>
<p>Victory screen, stage designate 0.</p>
<p>Menu screen, stage designate 1.</p>
<p>The following three conditional statements simply animate the menu screen, moving between two static images between update cycles.</p>
<p>Once the player presses enter, we begin the "loading" screen. Full disclosure: nothing is loading. However, the delay allows a player to prepare to play the game, rather than commencing play in the same second they press enter.</p>
<p>STAGE SET-UP</p>
<p>Stage Designate 2: Stage 1</p>
<p>Stage Designate 3: Stage 2</p>
<p>The stage is defeated when all basic enemies have been defeated, largely because the other non-boss enemy class we had wanted to implement would run off the screen and destruct itself automatically well before the player cleared out all of the basics.</p>
<p>PREVIOUS UPDATE CLEANUP</p>
<p>Any enemy which has moved off the bottom of the screen is no longer interesting/useful and can be safely deleted.</p>
<p>We only care if friendly bullets move off the top of the screen or hostile bullets move off the bottom. If friendly bullets are moving off the bottom or hostile bullets off the top, that's incorrect behaviour.</p>
<p>UPDATE PLAYER</p>
<p>Check if the player is dead, and also if the player has exhausted all their allotted lives.</p>
<p>&lt; Changes to the game over screen.</p>
<p>Get input and move the player accordingly.</p>
<p>Check if the player has flown into any of the enemy objects.</p>
<p>Control firing of friendly bullets.</p>
<p>UPDATE ENEMIES</p>
<p>Move all elements of each enemy index.</p>
<p>Check to see if any of the enemy objects have collided with the player.</p>
<p>Check to see if any enemy should fire a bullet, and if so, generate it.</p>
<p>One or no basic enemies will fire a bullet each update phase, depending on a certain percentile chance.</p>
<p>UPDATE PROJECTILES</p>
<p>Move all bullets.</p>
<p>Check for collision between bullets and valid targets.</p>
<p>DRAW ALL OBJECTS</p>
<p>Draw the player.</p>
<p>Draw the enemies.</p>
<p>Draw the bullets.</p>
<p>&lt; Updates the display.</p>
<p>&lt; Clear the display to the bg color in preparation for the next draw.</p>
<p>Clean up spriteIndex.</p>
<p>Clean up unwrapped allegro objects.</p>
<p>End the program. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
